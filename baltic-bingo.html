<!DOCTYPE html>
<html>
<head>
  <title>ðŸ‡ªðŸ‡ª Baltic Bingo</title>
  <meta charset="UTF-8">
	<meta name="andrewzc" content="exclude" />
  <meta name="viewport" content="width=800">
  <link rel="stylesheet" href="styles.css">
  <style>
    td { white-space: nowrap; }
    th { text-align: center; }
    table { border-spacing: 0px; }
    .countries tr td:not(:first-child) { width: 130px; opacity: 0.8; }
    .states tr td:not(:first-child) { width: 72px; opacity: 0.8; }
    .ratio { text-align: center; color: #444; }
  </style>
</head>
<body>
<div class="headline">ðŸ‡ªðŸ‡ª Baltic Bingo</div>
<div class="items small">
  <table id="table" class="countries"></table>
  <br>
  <div id="map" lat="57" lon="24.5" zoom="7" cluster="false" style="height: 1050px;"></div>
  <div id="lists"></div>
</div>
<script src="map.js"></script>
<script src="bingo.js"></script>
<script>
  
const places = [
  { key: "estonia", name: "Estonia", icon: "ðŸ‡ªðŸ‡ª", confluences: 6 },
  { key: "latvia", name: "Latvia", icon: "ðŸ‡±ðŸ‡»", confluences: 9 },
  { key: "lithuania", name: "Lithuania", icon: "ðŸ‡±ðŸ‡¹", confluences: 9 },
];

const pages = [
  { key: "capitals", name: "Capitals", icon: "ðŸ›", hideTotal: true },
  { key: "highest", name: "Highest", icon: "ðŸ”ï¸", hideTotal: true, sort: "reversePrefix" },
  { key: "lowest", name: "Lowest", icon: "ðŸ¤¿", hideTotal: true, sort: "prefix" },
  { key: "extremities", name: "Extremities", icon: "ðŸ§­", hideTotal: true, fixedTotal: 4, include: ["Lavry", "SuwaÅ‚ki", "Zilupe"] },
  { key: "tripoints", name: "Tripoints", icon: "ðŸš©", sort: "been" },
  { key: "confluence", name: "Confluence", icon: "ðŸš¸", 
    include: ["PÅ‚ociczno", "Sovyetsk", "Mukvyatitsa"], 
    exclude: ["Å½virblaiÄiai", "DrÄ…suÄiai", "Valdeikiai", "Rulli", "MÄlpils", "Vadi", "Lau", "MieriÅ†i"]},
  { key: "unesco", name: "Heritage", icon: "ðŸ‡ºðŸ‡³" },
  { key: "struve", name: "Struve", icon: "ðŸ“" },
  { key: "trams", name: "Trams", icon: "ðŸš‹"},

  { key: "airports", name: "Airports", icon: "ðŸ›«", hide: true },
  { key: "beaches", name: "Beaches", icon: "ðŸ–ï¸", hide: true, exclude: ["Ventspils", "Narva-JÃµesuu", "InÄupe", "Å ventoji", "Pikakari", "VecÄÄ·i"] },
  { key: "cable-cars", name: "Cable Cars", icon: "ðŸš¡", hide: true },
  { key: "castles", name: "Castles", icon: "ðŸ°", hide: true, exclude: ["Bauska Castle", "Raudondvaris Castle", "Kadriorg Palace", "CÄ“sis Castle"] },
  { key: "cathedrals", name: "Cathedrals", icon: "â›ªï¸", hide: true },
  { key: "closed-cities", name: "Closed Cities", icon: "â›”", hide: true, exclude: ["SillamÃ¤e", "Paldiski"] },
  { key: "enclaves", name: "Enclaves", icon: "ðŸ©", hide: true, include: ["Kaliningrad"] },
  { key: "forts", name: "Forts", icon: "ðŸª–", hide: true, exclude: ["Kaunas I", "Kaunas II", "Kaunas III", "Kaunas IV", "Kaunas V", "Kaunas VI", "Kaunas VII", "Kaunas VIII", "Kaunas IX", "Kaunas X"] },
  { key: "funiculars", name: "Funiculars", icon: "ðŸš ", hide: true },
  { key: "ikea", name: "IKEA", icon: "ðŸ‡¸ðŸ‡ª", hide: true, exclude: ["Tallinn"] },
  { key: "highway-strips", name: "Highway Strips", icon: "ðŸ›¬", hide: true, exclude: ["JÃ¤gala", "PanevÄ—Å¾ys", "Kartena"] },
  { key: "hotels", name: "Hotels", icon: "ðŸ¨", hide: true },
  { key: "lighthouses", name: "Lighthouses", icon: "ðŸ•¯ï¸", hide: true, exclude: ["Kiipsaare", "KÃµpu", "Ristna", "Vilsandi", "MÄ“rsrags", "AinaÅ¾i", "VentÄ— Cape", "Uostadvaris"] },
  // { key: "loops", name: "Loops", icon: "ðŸŽˆ", hide: true },
  { key: "planned", name: "Planned Cities", icon: "ðŸ‘·â€â™‚ï¸", hide: true, exclude: ["Paldiski", "Elektrenai", "VÃµru"] },
  { key: "power-stations", name: "Power Stations", icon: "â˜¢ï¸", hide: true, exclude: ["Kohtla-JÃ¤rve"] },
  { key: "ports", name: "Ports", icon: "âš“ï¸", hide: true, exclude: ["Paldiski"] },
  { key: "salients", name: "Salients", icon: "ðŸ³", hide: true },
  { key: "short-coastline", name: "Short Coastline", icon: "ðŸ–ï¸", hide: true },
  { key: "spas", name: "Spas", icon: "â™¨ï¸", hide: true, exclude: ["Elamus Spa", "Kalev Spa Water Park"] },
  { key: "stations", name: "Stations", icon: "ðŸš‰", hide: true, exclude: ["Kaunas"] },
  { key: "swimming", name: "Swimming", icon: "ðŸ¤½â€â™‚ï¸", hide: true, include: ["WiÅ¼ajny"] },
  { key: "towers", name: "Towers", icon: "ðŸ—¼", hide: true },
  { key: "trolleybuses", name: "Trolleybuses", icon: "ðŸšŽ", hide: true },
];

const route = [
  [56.92361111, 23.97111111], // Riga
  [57.0, 24.0], // Riga
  [57.00550, 23.92262], // JÅ«rmala
  [56.974168, 23.860229], // LÄ«vu Akvaparks
  [56.93830000, 23.48940000], // Ä¶emeri
  [57.0, 23.0], // Vilksala
  [56.96666667, 21.96666667], // KuldÄ«ga
  [56.66666667, 22.00000000], // Skrunda
  [56.52414167, 21.01692500], // LiepÄja
  [56.35519, 20.97349], // Cape BernÄti
  [56.02519444, 21.08238889], // Å ventoji
  [55.72794444, 21.09566667], // KlaipÄ—da
  [55.55658333, 21.11580556], // JuodkrantÄ—
  [55.41221, 21.06148],
  [55.27444444, 20.97083333], // Curonian Spit
  [55.41221, 21.06148],
  [55.55658333, 21.11580556], // JuodkrantÄ—
  [55.72794444, 21.09566667], // KlaipÄ—da
  [55.08508, 21.88724], // Kaliningrad
  [55.08048, 22.74448],
  [54.99969000, 23.00008000], // RitiniÅ³ Tvenkinys    
  [54.89174000, 23.81834000], // Kaunas XI
  [54.89700000, 23.88900000], // Kaunas
  [54.99979000, 23.99997000], // DidÅ¾iosios LapÄ—s
  [54.87070, 23.98973],
  [54.45307000, 22.70352000], // ViÅ¡tytis
  [54.45340, 22.73981],
  [54.36250000, 22.79055556], // WiÅ¼ajny
  [54.22618000, 23.38525000], // Filicijanavas
  [54.02282170, 23.97210760], // Druskininkai Aquapark
  [54.0, 24.0], // Druskininkai
  [54.32020, 25.51327],
  [54.19444444, 25.62500000], // DieveniÅ¡kÄ—s
  [54.32636, 25.53658],
  [54.6196240,25.4178212], // Auroradream
  [54.52708333, 25.62605556], // AukÅ¡tojas Hill
  [54.53888889, 25.65000000], // Medininkai Castle
  [54.68583333, 25.28777778], // Vilnius
  [54.74565000, 25.29545000], // Valakampiai
  [54.65250000, 24.93305556], // Trakai Island Castle
  [54.88333333, 24.85000000], // KernavÄ—
  [55.0, 25.0], // AviÅ¾onys
  [54.93083333, 25.31666667], // Meschkanzi MeÅ¡konys
  [55.0, 26.0], // Zalavas
  [55.13402, 26.15822],
  [55.15667, 26.58996],
  [55.30500000, 26.82000000], // VosiÅ«nai
  [55.32120, 26.40604],
  [55.49045000, 26.40768000], // Dysnai
  [55.60444444, 26.56000000], // Ignalina
  [55.59800000, 26.43800000], // Visaginas
  [55.68060, 26.63045], // Lake Ludvinava
  [55.72717000, 26.55078000], // BriÄ¡enes Ezers
  [55.88186000, 26.49473000], // Daugavpils Fortress
  [56.0, 27.0], // KazliÅ¡ki
  [56.12441500, 27.00991500], // Aglona
  [56.17018, 28.15136], // DraudzÄ«bas KurgÄns
  [56.28266, 28.23808], // Pasiene
  [56.33623300, 28.14177800], // ZaÄ¼esjes Ezers
  [56.54106, 27.30257],
  [56.50138889, 25.85666667], // Jacobstadt
  [56.0, 26.0], // Gulbene
  [55.99864200, 25.89818800], // Rokiskis
  [55.90250000, 25.43666667], // Karischki GireiÅ¡iai
  [55.90212000, 25.00266000], // KupiÅ¡kÄ—nÅ³ StarkÄ—nas
  [56.0, 25.0], // Alizava
  [56.11888890, 24.95222220], // BirÅ¾ai
  [56.44959, 24.88634], // LemkinÄ—
  [56.60474000, 25.03934000], // Daugava
  [56.84000000, 25.63666667], // Sestu-Kalns Ziestu
  [56.86237000, 25.84406000], // KÄlezers
  [56.87025833, 25.95935556], // GaiziÅ†kalns
  [57.0, 26.0], // MÄ“dzula
  [57.50896, 26.61603], // KarisÃ¶Ã¶di
  [57.41926, 27.07245],
  [57.51105, 27.37016], // Parmu
  [57.52259, 27.20356],
  [57.58204000, 27.23523000], // Hino
  [57.71444444, 27.05916667], // Suur MunamÃ¤gi
  [57.83910, 27.59459],
  [57.84830, 27.69133],
  [57.90436, 27.72940],
  [57.91638889, 27.71111111], // LutepÃ¤Ã¤
  [57.92477, 27.67767],
  [58.0, 27.0], // Meemaste
  [58.3703397,26.7144742], // Hektor Design Hostel
  [58.39215000, 26.71143000], // Tartu EmajÃµe
  [58.84785, 26.95008], // Mustvee
  [59.04833333, 26.41416667], // Katko
  [59.05777778, 26.33777778], // Woibifer
  [59.0, 26.0], // Ramma
  [59.67527778, 25.69694444], // Purekkari
  [59.46291, 25.63979],
  [59.43995000, 24.73715000], // Talinn
  [59.0, 24.0], // Risti
  [59.0222286,23.5675532], // Saare Manor Guesthouse
  [59.02557, 23.40483], // Cape Ramsi
  [58.94722222, 23.53861111], // Haapsalu Castle
  [58.56638890, 23.79666670], // Vatla
  [58.37608000, 24.48746000], // PÃ¤rnu
  [58.08577, 25.19943], // IpiÄ·i
  [58.0, 25.0], // Talcis
  [57.70078000, 25.27354000], // Burtnieki
  [57.16565833, 24.84971111], // Sigulda Castle
  [56.92361111, 23.97111111], // Riga
];

document.addEventListener('mapReady', (e) => {
  var map = e.detail.map; 
  L.polyline(route, {
    color: '#097969',
    weight: 7,
    opacity: 0.4
  }).addTo(map);
});

function haversineKm(a, b) {
  const [lat1, lon1] = a;
  const [lat2, lon2] = b;

  const toRad = d => (d * Math.PI) / 180;
  const R = 6371.0; // km, same as your Swift version

  const Ï†1 = toRad(lat1);
  const Ï†2 = toRad(lat2);
  const Î”Ï† = toRad(lat2 - lat1);
  const Î”Î» = toRad(lon2 - lon1);

  const sinÎ”Ï† = Math.sin(Î”Ï† / 2);
  const sinÎ”Î» = Math.sin(Î”Î» / 2);

  const aH = sinÎ”Ï† * sinÎ”Ï† +
            Math.cos(Ï†1) * Math.cos(Ï†2) *
            sinÎ”Î» * sinÎ”Î»;

  const c = 2 * Math.atan2(Math.sqrt(aH), Math.sqrt(1 - aH));
  return R * c;
}

function routeLengthKm(points) {
  if (!Array.isArray(points) || points.length < 2) return 0;
  let total = 0;
  for (let i = 1; i < points.length; i++) {
    total += haversineKm(points[i - 1], points[i]);
  }
  return total;
}

// console.log(routeLengthKm(route).toFixed(1), 'km');

(async function init() {
  createHeader();
  await bingoMain("countries");
  showPlaces(mapPlaces);
})();

</script>
</body>
</html>
